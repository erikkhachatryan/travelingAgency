<ui:composition xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
<f:view>
    <h:form id="loginFormId" rendered="#{!loginForm.loggedIn}">
        <h:panelGroup id="userNamePanelGroupId" layout="block">
            <p:outputLabel id="userNameOutputTextId" value="User Name"/>
            <p:inputText id="userNameInputTextId" value="#{loginForm.currentUser.name}"
                         required="true" requiredMessage="User Name is required.">
                <p:ajax process="@this" update="@this" />
            </p:inputText>
            <p:message id="userNameRequiredMessageId" for="userNameInputTextId" />
        </h:panelGroup>
        <h:panelGroup id="passwordPanelGroupId" layout="block">
            <p:outputLabel id="passwordOutputTextId" value="Password"/>
            <p:inputText id="passwordInputTextId" value="#{loginForm.currentUser.password}"
                         required="true" requiredMessage="Password is required." type="password">
                <p:ajax process="@this" update="@this" />
            </p:inputText>
            <p:message id="passwordRequiredMessageId" for="passwordInputTextId" />
        </h:panelGroup>

        <p:message id="loginValidationMessageId" for="loginValidatorId" />

        <h:inputHidden value="true" id="loginValidatorId">
            <f:validator validatorId="loginValidator" for="loginValidatorId" />
            <f:attribute name="process" value="#{not empty param[loginButtonBinding.clientId]}" />
            <f:attribute name="message" value="Wrong User Name and/or password." />
            <f:attribute name="currentUser" value="#{loginForm.currentUser}" />
            <f:attribute name="allUsers" value="#{loginForm.users}" />
        </h:inputHidden>

        <p:commandButton id="loginButtonId" value="Login"
                         binding="#{loginButtonBinding}"
                         update="deFormId" />
        <p:commandButton id="registerButtonId" value="Register"
                         update="deFormId:registrationDialogId"
                         process="@this deFormId:registrationDialogId"
                         oncomplete="PF('registrationDialog').show();"/>
    </h:form>
</f:view>
</ui:composition>
