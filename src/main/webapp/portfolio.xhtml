<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
<h:head>
    <title>Traveling Agency</title>
    <script src="general.js" type="text/javascript"></script>
    <link type="text/css" rel="stylesheet" href="style.css" />
</h:head>
<h:body>
    <f:view>
        <p:ajaxStatus onstart="PF('statusDialog').show()" onsuccess="PF('statusDialog').hide()" />

        <p:dialog widgetVar="statusDialog" modal="true" draggable="false" closable="false" resizable="false" showHeader="false">
            <p:graphicImage url="images/loading.gif" alt="Loading..." />
        </p:dialog>
        <h:form id="deFormId">
            <ui:include src="deFormHeader.xhtml" />

            <h:panelGroup id="allLocationsPanelGroupId" layout="block" styleClass="content">
                <ui:repeat value="#{portfolioForm.travelingLocations}" var="travelingLocation">
                    <h:panelGroup style="display: inline-block">
                        <p:commandLink id="#{travelingLocation.LocationName}EditCommandLinkId"
                                       rendered="#{portfolioForm.loggedInAsAdministrator}"
                                       actionListener="#{travelingLocationSubForm.prepareEditing(travelingLocation)}"
                                       update="@this travelingLocationDialogId"
                                       process="@this travelingLocationDialogId"
                                       title="#{travelingLocation.LocationName}"
                                       oncomplete="PF('travelingLocationDialog').show();">
                            <p:graphicImage url="#{portfolioForm.getPhotoUrl(travelingLocation)}" alt="#{travelingLocation.LocationName}" styleClass="locationImage" />
                        </p:commandLink>
                        <p:commandLink id="#{travelingLocation.LocationName}ViewCommandLinkId"
                                       rendered="#{not portfolioForm.loggedInAsAdministrator and portfolioForm.loggedIn}"
                                       actionListener="#{travelingLocationSubForm.prepareViewing(travelingLocation)}"
                                       update="@this travelingLocationDialogId"
                                       process="@this travelingLocationDialogId"
                                       title="#{travelingLocation.LocationName}"
                                       oncomplete="PF('travelingLocationDialog').show();">
                            <p:graphicImage url="#{portfolioForm.getPhotoUrl(travelingLocation)}" alt="#{travelingLocation.LocationName}" styleClass="locationImage" />
                        </p:commandLink>
                        <p:graphicImage url="#{portfolioForm.getPhotoUrl(travelingLocation)}"
                                        title="#{travelingLocation.LocationName}"
                                        styleClass="locationImage"
                                        alt="#{travelingLocation.LocationName}"  rendered="#{not portfolioForm.loggedIn}" />
                    </h:panelGroup>
                </ui:repeat>
            </h:panelGroup>

            <p:commandButton id="locationAddButtonId"
                             value="Add Location"
                             actionListener="#{travelingLocationSubForm.prepareAdding}"
                             rendered="#{portfolioForm.loggedInAsAdministrator}"
                             styleClass="saveButton"
                             update="@this travelingLocationDialogId"
                             process="@this travelingLocationDialogId"
                             oncomplete="PF('travelingLocationDialog').show();"/>

            <p:commandButton id="viewBookingsButtonId"
                             value="View Bookings"
                             rendered="#{portfolioForm.loggedIn and (not portfolioForm.loggedInAsAdministrator)}"
                             styleClass="saveButton"
                             actionListener="#{viewBookingsSubForm.prepareForm}"
                             update="@this viewBookingsDialogId"
                             process="@this viewBookingsDialogId"
                             oncomplete="PF('viewBookingsDialog').show();"/>

        </h:form>
        <ui:include src="subForms/travelingLocation.xhtml"/>
        <ui:include src="subForms/sightSeeing.xhtml"/>
        <ui:include src="subForms/viewBookings.xhtml"/>
        <ui:include src="subForms/booking.xhtml"/>
        <ui:include src="subForms/trip.xhtml"/>
    </f:view>
</h:body>
</html>
